<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Anxiety Trend</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="https://github.com/KellyLuo233/mental_illness.github.io.git">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="data_process.html">Data Process</a>
</li>
<li>
  <a href="mental_illness.html">Mental Illness</a>
</li>
<li>
  <a href="anxiety_trend_dashboard.html">Anxiety Trend Dashboard</a>
</li>
<li>
  <a href="anxiety_trend.html">Anxiety Trend</a>
</li>
<li>
  <a href="depression_trend_dashboard.html">Depression Trend Dashboard</a>
</li>
<li>
  <a href="depression_trend.html">Depression Trend</a>
</li>
<li>
  <a href="suicide_analysis.html">Suicide Analysis</a>
</li>
<li>
  <a href="statistical_analysis.html">Statistical Analysis</a>
</li>
<li>
  <a href="project_report.html">Project Report</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Anxiety Trend</h1>

</div>


<pre class="r"><code>anx_dep = 
  read_csv(&quot;data/nhis_data01.csv&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  filter(year&gt;=2015) %&gt;% 
  select(year, worrx, worfreq, worfeelevl, deprx, depfreq, depfeelevl, age, sex, marst, poverty) %&gt;% 
  mutate(
    sex = recode_factor(sex, 
                        &quot;1&quot; = &quot;Male&quot;, 
                        &quot;2&quot; = &quot;Female&quot;),
    marst = recode_factor(marst, 
                        &quot;10&quot; = &quot;Married&quot;, &quot;11&quot; = &quot;Married&quot;, &quot;12&quot; = &quot;Married&quot;, &quot;13&quot; = &quot;Married&quot;,
                        &quot;20&quot; = &quot;Widowed&quot;,
                        &quot;30&quot; = &quot;Divorced&quot;,
                        &quot;40&quot; = &quot;Separated&quot;,
                        &quot;50&quot; = &quot;Never married&quot;),
    poverty = recode_factor(poverty, 
                        &quot;11&quot; = &quot;Less than 1.0&quot;, &quot;12&quot; = &quot;Less than 1.0&quot;, 
                        &quot;13&quot; = &quot;Less than 1.0&quot;, &quot;14&quot; = &quot;Less than 1.0&quot;,
                        &quot;21&quot; = &quot;1.0-2.0&quot;, &quot;22&quot; = &quot;1.0-2.0&quot;, 
                        &quot;23&quot; = &quot;1.0-2.0&quot;, &quot;24&quot; = &quot;1.0-2.0&quot;, 
                        &quot;25&quot; = &quot;1.0-2.0&quot;,
                        &quot;31&quot; = &quot;2.0 and above&quot;,&quot;32&quot; = &quot;2.0 and above&quot;,
                        &quot;33&quot; = &quot;2.0 and above&quot;,&quot;34&quot; = &quot;2.0 and above&quot;,
                        &quot;35&quot; = &quot;2.0 and above&quot;,&quot;36&quot; = &quot;2.0 and above&quot;,
                        &quot;37&quot; = &quot;2.0 and above&quot;,&quot;38&quot; = &quot;2.0 and above&quot;),
    worrx = recode_factor(worrx,
                          &#39;1&#39; = &quot;no&quot;, 
                          &#39;2&#39; = &quot;yes&quot;),
    worfreq = recode_factor(worfreq, 
                            &#39;1&#39; = &quot;Daily&quot;, 
                            &#39;2&#39; = &quot;Weekly&quot;, 
                            &#39;3&#39; = &quot;Monthly&quot;, 
                            &#39;4&#39; = &quot;A few times a year&quot;, 
                            &#39;5&#39; = &quot;Never&quot;),
    worfeelevl = recode_factor(worfeelevl, 
                               &#39;1&#39; = &quot;A lot&quot;, 
                               &#39;3&#39; = &quot;Somewhere between a little and a lot&quot;, 
                               &#39;2&#39; = &quot;A little&quot;),
    deprx = recode_factor(deprx, &#39;1&#39; = &quot;no&quot;, &#39;2&#39; = &quot;yes&quot;),
    depfreq = recode_factor(depfreq, &#39;1&#39; = &quot;Daily&quot;, &#39;2&#39; = &quot;Weekly&quot;, 
                            &#39;3&#39; = &quot;Monthly&quot;, &#39;4&#39; = &quot;A few times a year&quot;, 
                            &#39;5&#39; = &quot;Never&quot;),
    depfeelevl = recode_factor(depfeelevl, &#39;1&#39; = &quot;A lot&quot;, 
                               &#39;3&#39; = &quot;Somewhere between a little and a lot&quot;, 
                               &#39;2&#39; = &quot;A little&quot;),
    age = ifelse(age&gt;=85, NA, age)
    )</code></pre>
<div id="anxiety-trend" class="section level2">
<h2>Anxiety Trend</h2>
<div
id="percentage-of-people-reported-taken-medication-for-worried-nervous-or-anxious-feelings"
class="section level3">
<h3>Percentage of people reported taken medication for worried, nervous,
or anxious feelings</h3>
<p>According to the plot, from 2015 to 2021, the percentage of people
who report taking medication for worry, stress or anxiety is constantly
increasing from 9.13% in 2015 to 13.57% in 2021. We can observe a rapid
increase from 2017 to 2019 and, contrary to our expectations, a
relatively slow increase from 2019 to 2020. The effect of COVID-19 on
anxiety is not evident in this plot.</p>
<pre class="r"><code>anx_dep %&gt;%
  drop_na(worrx) %&gt;% 
  group_by(year, worrx) %&gt;% 
  summarize(wor_num = n()) %&gt;% 
  pivot_wider(
    names_from = worrx,
    values_from = wor_num
  ) %&gt;% 
  mutate(
    wor_percentage = yes/(no + yes)*100,
    text_label = str_c(yes, &quot; out of &quot;, no + yes)
  ) %&gt;% 
  ungroup() %&gt;% 
  plot_ly(
    y = ~wor_percentage,
    x = ~year,
    color = ~year,
    type = &quot;bar&quot;, 
    colors = &quot;viridis&quot;,
    text = ~text_label
  ) %&gt;% 
  layout(
    xaxis = list (title = &quot;&quot;),
    yaxis = list (title = &quot;Percentage&quot;),
    showlegend = FALSE
  ) %&gt;% 
  hide_colorbar()</code></pre>
<div id="htmlwidget-205a00f7984e928d7554" style="width:90%;height:576px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-205a00f7984e928d7554">{"x":{"visdat":{"bbbc4c7f6b62":["function () ","plotlyVisDat"]},"cur_data":"bbbc4c7f6b62","attrs":{"bbbc4c7f6b62":{"y":{},"x":{},"text":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":""},"yaxis":{"domain":[0,1],"automargin":true,"title":"Percentage"},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"y":[9.12887061544392,10.056854074542,10.4051636985769,11.5031671268475,12.7483969271792,13.1244789328545,13.5677173536543],"x":[2015,2016,2017,2018,2019,2020,2021],"text":["1421 out of 15566","1592 out of 15830","1338 out of 12859","2833 out of 24628","4016 out of 31502","4093 out of 31186","3917 out of 28870"],"type":"bar","marker":{"colorbar":{"title":"year","ticklen":2},"cmin":2015,"cmax":2021,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(71,17,100,1)"],["0.0833333333333333","rgba(72,31,112,1)"],["0.125","rgba(71,45,123,1)"],["0.166666666666667","rgba(68,58,131,1)"],["0.208333333333333","rgba(64,70,136,1)"],["0.25","rgba(59,82,139,1)"],["0.291666666666667","rgba(54,93,141,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(44,114,142,1)"],["0.416666666666667","rgba(40,124,142,1)"],["0.458333333333333","rgba(36,134,142,1)"],["0.5","rgba(33,144,141,1)"],["0.541666666666667","rgba(31,154,138,1)"],["0.583333333333333","rgba(32,164,134,1)"],["0.625","rgba(39,173,129,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(71,193,110,1)"],["0.75","rgba(93,200,99,1)"],["0.791666666666667","rgba(117,208,84,1)"],["0.833333333333333","rgba(143,214,68,1)"],["0.875","rgba(170,220,50,1)"],["0.916666666666667","rgba(199,224,32,1)"],["0.958333333333333","rgba(227,228,24,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[2015,2016,2017,2018,2019,2020,2021],"line":{"colorbar":{"title":"","ticklen":2},"cmin":2015,"cmax":2021,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(71,17,100,1)"],["0.0833333333333333","rgba(72,31,112,1)"],["0.125","rgba(71,45,123,1)"],["0.166666666666667","rgba(68,58,131,1)"],["0.208333333333333","rgba(64,70,136,1)"],["0.25","rgba(59,82,139,1)"],["0.291666666666667","rgba(54,93,141,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(44,114,142,1)"],["0.416666666666667","rgba(40,124,142,1)"],["0.458333333333333","rgba(36,134,142,1)"],["0.5","rgba(33,144,141,1)"],["0.541666666666667","rgba(31,154,138,1)"],["0.583333333333333","rgba(32,164,134,1)"],["0.625","rgba(39,173,129,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(71,193,110,1)"],["0.75","rgba(93,200,99,1)"],["0.791666666666667","rgba(117,208,84,1)"],["0.833333333333333","rgba(143,214,68,1)"],["0.875","rgba(170,220,50,1)"],["0.916666666666667","rgba(199,224,32,1)"],["0.958333333333333","rgba(227,228,24,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[2015,2016,2017,2018,2019,2020,2021]}},"xaxis":"x","yaxis":"y","frame":null},{"x":[2015,2021],"y":[9.12887061544392,13.5677173536543],"type":"scatter","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"colorbar":{"title":"year","ticklen":2},"cmin":2015,"cmax":2021,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(71,17,100,1)"],["0.0833333333333333","rgba(72,31,112,1)"],["0.125","rgba(71,45,123,1)"],["0.166666666666667","rgba(68,58,131,1)"],["0.208333333333333","rgba(64,70,136,1)"],["0.25","rgba(59,82,139,1)"],["0.291666666666667","rgba(54,93,141,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(44,114,142,1)"],["0.416666666666667","rgba(40,124,142,1)"],["0.458333333333333","rgba(36,134,142,1)"],["0.5","rgba(33,144,141,1)"],["0.541666666666667","rgba(31,154,138,1)"],["0.583333333333333","rgba(32,164,134,1)"],["0.625","rgba(39,173,129,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(71,193,110,1)"],["0.75","rgba(93,200,99,1)"],["0.791666666666667","rgba(117,208,84,1)"],["0.833333333333333","rgba(143,214,68,1)"],["0.875","rgba(170,220,50,1)"],["0.916666666666667","rgba(199,224,32,1)"],["0.958333333333333","rgba(227,228,24,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[2015,2021],"line":{"color":"rgba(255,127,14,1)"}},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div id="stratify-by-biological-sex" class="section level4">
<h4>Stratify by Biological sex</h4>
<p>Stratify the reported percentage of people taking medication for
worried, nervous, or anxious feelings by biological sex, we can observe
a much higher percentage among females than males. There is also a
faster increase in the percentage among females from 14.41% in 2018 to
16.52% in 2019. This increase may indicate COVID-19-induced anxiety in
females. Among males, the percentage is relatively stable from 2018 to
2020, while there is an increase from 2020 to 2021.</p>
<pre class="r"><code>anx_dep %&gt;%
  drop_na(sex, worrx) %&gt;% 
  group_by(sex, year, worrx) %&gt;% 
  summarize(wor_num = n()) %&gt;% 
  pivot_wider(
    names_from = worrx,
    values_from = wor_num
  ) %&gt;% 
  mutate(
    wor_percentage = yes/(no + yes)*100,
    text_label = str_c(yes, &quot; out of &quot;, no + yes)
  ) %&gt;% 
  ungroup() %&gt;% 
  plot_ly(
    y = ~wor_percentage,
    x = ~year,
    color = ~sex,
    type = &quot;bar&quot;, 
    colors = &quot;viridis&quot;,
    text = ~text_label
  ) %&gt;% 
  add_trace(
    x = ~year,
    y = ~wor_percentage,
    color = ~sex,
    type=&#39;scatter&#39;,
    mode=&#39;lines+markers&#39;
  ) %&gt;% 
  layout(
    xaxis = list (title = &quot;&quot;),
    yaxis = list (title = &quot;Percentage&quot;),
    legend = list(orientation = &#39;h&#39;)
  )</code></pre>
<div id="htmlwidget-68afcbc89cbdbc269d6b" style="width:90%;height:576px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-68afcbc89cbdbc269d6b">{"x":{"visdat":{"bbbc70439aa":["function () ","plotlyVisDat"]},"cur_data":"bbbc70439aa","attrs":{"bbbc70439aa":{"y":{},"x":{},"text":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"},"bbbc70439aa.1":{"y":{},"x":{},"text":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","mode":"lines+markers","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":""},"yaxis":{"domain":[0,1],"automargin":true,"title":"Percentage"},"legend":{"orientation":"h"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"y":[6.24910624910625,6.92137320044297,6.92781388983921,8.02958738080385,8.34079482057993,8.33797715241014,9.18935407610768],"x":[2015,2016,2017,2018,2019,2020,2021],"text":["437 out of 6993","500 out of 7224","405 out of 5846","901 out of 11221","1211 out of 14519","1197 out of 14356","1205 out of 13113"],"type":"bar","name":"Male","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"y":[11.4778957191182,12.6888217522659,13.3038642521032,14.4103826359365,16.5194346289753,17.2094128832898,17.2072357981593],"x":[2015,2016,2017,2018,2019,2020,2021],"text":["984 out of 8573","1092 out of 8606","933 out of 7013","1932 out of 13407","2805 out of 16980","2896 out of 16828","2711 out of 15755"],"type":"bar","name":"Female","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null},{"y":[6.24910624910625,6.92137320044297,6.92781388983921,8.02958738080385,8.34079482057993,8.33797715241014,9.18935407610768],"x":[2015,2016,2017,2018,2019,2020,2021],"text":["437 out of 6993","500 out of 7224","405 out of 5846","901 out of 11221","1211 out of 14519","1197 out of 14356","1205 out of 13113"],"type":"scatter","mode":"lines+markers","name":"Male","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"line":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"y":[11.4778957191182,12.6888217522659,13.3038642521032,14.4103826359365,16.5194346289753,17.2094128832898,17.2072357981593],"x":[2015,2016,2017,2018,2019,2020,2021],"text":["984 out of 8573","1092 out of 8606","933 out of 7013","1932 out of 13407","2805 out of 16980","2896 out of 16828","2711 out of 15755"],"type":"scatter","mode":"lines+markers","name":"Female","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"line":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="stratify-by-ratio-of-family-income-to-poverty-threshold"
class="section level4">
<h4>Stratify by ratio of family income to poverty threshold</h4>
<p>Stratify the percentage of people reported taken medication for
worried, nervous, or anxious feelings by the ratio of household income
to the poverty line, we can clearly see that the poorer the household,
the higher their percentage. The percentage among the poorest stratum
decreased rapidly from 17.30% in 2017 to 15.84% in 2018, which is the
opposite of what happened in the other two strata. Although the
percentage of the poorest strata decreased rapidly from 2017 to 2018,
they still had the highest percentage of the three strata, and this
decrease was followed by a rapid increase from 15.84% in 2018 to 18.58%
in 2019, which may indicate that people belonging to the poorest stratum
are more susceptible to anxiety caused by COVID-19. From 2020 to 2021,
the percentage decreases for the other two strata, while for the richest
strata, the percentage steadily increases.</p>
<pre class="r"><code>anx_dep %&gt;%
  drop_na(poverty, worrx) %&gt;% 
  group_by(poverty, year, worrx) %&gt;% 
  summarize(wor_num = n()) %&gt;% 
  pivot_wider(
    names_from = worrx,
    values_from = wor_num
  ) %&gt;% 
  mutate(
    wor_percentage = yes/(no + yes)*100,
    text_label = str_c(yes, &quot; out of &quot;, no + yes)
  ) %&gt;% 
  ungroup() %&gt;% 
  plot_ly(
    y = ~wor_percentage,
    x = ~year,
    color = ~poverty,
    type = &quot;scatter&quot;, 
    mode = &quot;lines+markers&quot;,
    colors = &quot;viridis&quot;,
    text = ~text_label
  ) %&gt;% 
  layout(
    xaxis = list (title = &quot;&quot;),
    yaxis = list (title = &quot;Percentage&quot;),
    legend = list(orientation = &#39;h&#39;)
  )</code></pre>
<div id="htmlwidget-63f7c2917f12afb8e140" style="width:90%;height:576px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-63f7c2917f12afb8e140">{"x":{"visdat":{"bbbcc4f185d":["function () ","plotlyVisDat"]},"cur_data":"bbbcc4f185d","attrs":{"bbbcc4f185d":{"y":{},"x":{},"mode":"lines+markers","text":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":""},"yaxis":{"domain":[0,1],"automargin":true,"title":"Percentage"},"legend":{"orientation":"h"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"y":[14.5099703012304,15.0494159928122,17.3006134969325,15.8448150833938,18.584579976985,19.400289017341,18.0263626647667],"x":[2015,2016,2017,2018,2019,2020,2021],"mode":"lines+markers","text":["342 out of 2357","335 out of 2226","282 out of 1630","437 out of 2758","646 out of 3476","537 out of 2768","506 out of 2807"],"type":"scatter","name":"Less than 1.0","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"line":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"y":[9.67741935483871,10.9730113636364,11.3378684807256,13.3143128863528,15.3508000703359,15.0906609475531,14.3767423337316],"x":[2015,2016,2017,2018,2019,2020,2021],"mode":"lines+markers","text":["300 out of 3100","309 out of 2816","250 out of 2205","560 out of 4206","873 out of 5687","774 out of 5129","722 out of 5022"],"type":"scatter","name":"1.0-2.0","marker":{"color":"rgba(33,144,141,1)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,1)"},"error_y":{"color":"rgba(33,144,141,1)"},"error_x":{"color":"rgba(33,144,141,1)"},"line":{"color":"rgba(33,144,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"y":[7.8938958133589,8.99750623441397,9.12106135986733,10.4952403904085,11.1777608666458,11.9455536948774,12.7798108454921],"x":[2015,2016,2017,2018,2019,2020,2021],"mode":"lines+markers","text":["741 out of 9387","902 out of 10025","770 out of 8442","1742 out of 16598","2497 out of 22339","2782 out of 23289","2689 out of 21041"],"type":"scatter","name":"2.0 and above","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"line":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="stratify-by-current-martial-status" class="section level4">
<h4>Stratify by current martial status</h4>
<p>Stratify the percentage of people reported taken medication for
worried, nervous, or anxious feelings by current martial status, we can
observe a rapid increase from 10.61% in 2017 to 15.60% in 2019 among
those widowed, while it is difficult to tell whether this increase is
caused by COVID-19 as it starts at 2017. There is also a rapid increase
among those who are separated, from 14.31% in 2019 to 17.49% in 2020.
Considering the timing, this could be an effect of COVID-19. The trends
are similar for married and never married.</p>
<pre class="r"><code>anx_dep %&gt;%
  drop_na(marst, worrx) %&gt;% 
  group_by(marst, year, worrx) %&gt;% 
  summarize(wor_num = n()) %&gt;% 
  pivot_wider(
    names_from = worrx,
    values_from = wor_num
  ) %&gt;% 
  mutate(
    wor_percentage = yes/(no + yes)*100,
    text_label = str_c(yes, &quot; out of &quot;, no + yes)
  ) %&gt;% 
  ungroup() %&gt;% 
  plot_ly(
    y = ~wor_percentage,
    x = ~year,
    color = ~marst,
    type = &quot;scatter&quot;,
    mode=&#39;lines+markers&#39;,
    colors = &quot;viridis&quot;,
    text = ~text_label
  ) %&gt;% 
  layout(
    xaxis = list (title = &quot;&quot;),
    yaxis = list (title = &quot;Percentage&quot;),
    legend = list(orientation = &#39;h&#39;)
  )</code></pre>
<div id="htmlwidget-f0b6203f6fc083a871bd" style="width:90%;height:576px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-f0b6203f6fc083a871bd">{"x":{"visdat":{"bbbc50b74b0f":["function () ","plotlyVisDat"]},"cur_data":"bbbc50b74b0f","attrs":{"bbbc50b74b0f":{"y":{},"x":{},"mode":"lines+markers","text":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":""},"yaxis":{"domain":[0,1],"automargin":true,"title":"Percentage"},"legend":{"orientation":"h"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"y":[7.72813273177121,8.28133862733976,8.88888888888889,10.2336825141015,11.4115335095209,11.5122615803815,12.4076147816349],"x":[2015,2016,2017,2018,2019,2020,2021],"mode":"lines+markers","text":["531 out of 6871","584 out of 7052","504 out of 5670","1143 out of 11169","1684 out of 14757","1690 out of 14680","1662 out of 13395"],"type":"scatter","name":"Married","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"line":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"y":[10.5769230769231,10.644959298685,10.6106870229008,12.7447063523771,15.5954631379962,14.6658415841584,14.2068965517241],"x":[2015,2016,2017,2018,2019,2020,2021],"mode":"lines+markers","text":["165 out of 1560","170 out of 1597","139 out of 1310","319 out of 2503","495 out of 3174","474 out of 3232","412 out of 2900"],"type":"scatter","name":"Widowed","marker":{"color":"rgba(59,82,139,1)","line":{"color":"rgba(59,82,139,1)"}},"textfont":{"color":"rgba(59,82,139,1)"},"error_y":{"color":"rgba(59,82,139,1)"},"error_x":{"color":"rgba(59,82,139,1)"},"line":{"color":"rgba(59,82,139,1)"},"xaxis":"x","yaxis":"y","frame":null},{"y":[12.5201938610662,14.4395692062226,14.6960268070847,15.1591079929842,16.794509487283,17.1165644171779,17.1935410507164],"x":[2015,2016,2017,2018,2019,2020,2021],"mode":"lines+markers","text":["310 out of 2476","362 out of 2507","307 out of 2089","605 out of 3991","832 out of 4954","837 out of 4890","756 out of 4397"],"type":"scatter","name":"Divorced","marker":{"color":"rgba(33,144,141,1)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,1)"},"error_y":{"color":"rgba(33,144,141,1)"},"error_x":{"color":"rgba(33,144,141,1)"},"line":{"color":"rgba(33,144,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"y":[14.6853146853147,16.4044943820225,13.8107416879795,14.7727272727273,14.3141153081511,17.4897119341564,14.7505422993492],"x":[2015,2016,2017,2018,2019,2020,2021],"mode":"lines+markers","text":["63 out of 429","73 out of 445","54 out of 391","91 out of 616","72 out of 503","85 out of 486","68 out of 461"],"type":"scatter","name":"Separated","marker":{"color":"rgba(93,200,99,1)","line":{"color":"rgba(93,200,99,1)"}},"textfont":{"color":"rgba(93,200,99,1)"},"error_y":{"color":"rgba(93,200,99,1)"},"error_x":{"color":"rgba(93,200,99,1)"},"line":{"color":"rgba(93,200,99,1)"},"xaxis":"x","yaxis":"y","frame":null},{"y":[8.36112434492616,9.58512160228898,9.83412322274881,10.6399872955376,11.5089181096211,13.0465051517683,13.2901804159207],"x":[2015,2016,2017,2018,2019,2020,2021],"mode":"lines+markers","text":["351 out of 4198","402 out of 4194","332 out of 3376","670 out of 6297","884 out of 7681","937 out of 7182","965 out of 7261"],"type":"scatter","name":"Never married","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"line":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="age-distribution" class="section level3">
<h3>Age distribution</h3>
<p>As we can see from the plot, the age distribution of people taking
medication for worried, nervous, or anxious feelings did not change much
from 2015 to 2021.</p>
<pre class="r"><code>anx_dep %&gt;%
  drop_na(age, worrx) %&gt;% 
  ggplot(
    aes(x=age, group=worrx, fill=worrx)
  ) +
  geom_density(alpha=0.4) +
  facet_wrap(~year) +
  labs(
    fill = &quot;Whether taken medicine for anxiety&quot;
  )</code></pre>
<p><img src="anxiety_trend_files/figure-html/unnamed-chunk-6-1.png" width="90%" /></p>
</div>
<div id="frequency-of-worried-nervous-or-anxious-feelings"
class="section level3">
<h3>Frequency of worried, nervous, or anxious feelings</h3>
<p>From this bar plot about how often people feel worried, nervous, or
anxious, we can observe that the frequency is steadily increasing from
2015 to 2021. There is also a rapid increase from 2019 to 2020, which
could be caused by COVID-19.</p>
<pre class="r"><code>anx_dep %&gt;% 
  drop_na(worfreq) %&gt;% 
  group_by(year, worfreq) %&gt;% 
  summarize(count = n()) %&gt;% 
  group_by(year) %&gt;% 
  summarize(
     percentage=100 * count/sum(count),
     sum_count = sum(count),
     worfreq = worfreq,
     count=count
  ) %&gt;% 
  mutate(
    text_label = str_c(count, &quot; out of &quot;, sum_count)
  ) %&gt;% 
  plot_ly(
    y = ~percentage,
    x = ~year,
    color = ~worfreq,
    type = &quot;bar&quot;, 
    colors = &quot;viridis&quot;,
    text = ~text_label
  ) %&gt;% 
  layout(
    xaxis = list (title = &quot;&quot;),
    yaxis = list (title = &quot;Percentage&quot;), 
    barmode = &#39;stack&#39;,
    legend = list(orientation = &#39;h&#39;)
  )</code></pre>
<div id="htmlwidget-0ebe5f54cb2ea473adf6" style="width:90%;height:576px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-0ebe5f54cb2ea473adf6">{"x":{"visdat":{"bbbc413c221d":["function () ","plotlyVisDat"]},"cur_data":"bbbc413c221d","attrs":{"bbbc413c221d":{"y":{},"x":{},"text":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":""},"yaxis":{"domain":[0,1],"automargin":true,"title":"Percentage"},"barmode":"stack","legend":{"orientation":"h"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"y":[9.29035578717107,9.12427233611744,10.1824419148604,10.2452515557002,11.3056239844856,11.2907785379092,11.25],"x":[2015,2016,2017,2018,2019,2020,2021],"text":["1444 out of 15543","1442 out of 15804","1306 out of 12826","2519 out of 24587","4314 out of 38158","3994 out of 35374","3924 out of 34880"],"type":"bar","name":"Daily","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"y":[10.4355658495786,10.5163249810175,12.1004210198035,12.2422418351161,11.8376225169034,13.2809408039803,13.6267201834862],"x":[2015,2016,2017,2018,2019,2020,2021],"text":["1622 out of 15543","1662 out of 15804","1552 out of 12826","3010 out of 24587","4517 out of 38158","4698 out of 35374","4753 out of 34880"],"type":"bar","name":"Weekly","marker":{"color":"rgba(59,82,139,1)","line":{"color":"rgba(59,82,139,1)"}},"textfont":{"color":"rgba(59,82,139,1)"},"error_y":{"color":"rgba(59,82,139,1)"},"error_x":{"color":"rgba(59,82,139,1)"},"xaxis":"x","yaxis":"y","frame":null},{"y":[9.00083638937142,8.24474816502151,8.84141587400592,9.83446536787733,10.3647989936579,10.7904110363544,11.5538990825688],"x":[2015,2016,2017,2018,2019,2020,2021],"text":["1399 out of 15543","1303 out of 15804","1134 out of 12826","2418 out of 24587","3955 out of 38158","3817 out of 35374","4030 out of 34880"],"type":"bar","name":"Monthly","marker":{"color":"rgba(33,144,141,1)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,1)"},"error_y":{"color":"rgba(33,144,141,1)"},"error_x":{"color":"rgba(33,144,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"y":[27.2534259795406,31.4224247026069,30.8513956026821,30.9269125960874,30.0775721998008,31.9811160739526,31.1267201834862],"x":[2015,2016,2017,2018,2019,2020,2021],"text":["4236 out of 15543","4966 out of 15804","3957 out of 12826","7604 out of 24587","11477 out of 38158","11313 out of 35374","10857 out of 34880"],"type":"bar","name":"A few times a year","marker":{"color":"rgba(93,200,99,1)","line":{"color":"rgba(93,200,99,1)"}},"textfont":{"color":"rgba(93,200,99,1)"},"error_y":{"color":"rgba(93,200,99,1)"},"error_x":{"color":"rgba(93,200,99,1)"},"xaxis":"x","yaxis":"y","frame":null},{"y":[44.0198159943383,40.6922298152367,38.0243255886481,36.751128645219,36.4143823051523,32.6567535478035,32.4426605504587],"x":[2015,2016,2017,2018,2019,2020,2021],"text":["6842 out of 15543","6431 out of 15804","4877 out of 12826","9036 out of 24587","13895 out of 38158","11552 out of 35374","11316 out of 34880"],"type":"bar","name":"Never","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="level-of-worried-nervous-or-anxious-feelings"
class="section level3">
<h3>Level of worried, nervous, or anxious feelings</h3>
<p>From this bar plot about the level of worried, nervous, or anxious
feelings people felt last time, we can observe a relatively large
increase from 2018 to 2019 in the percentage of people who felt worried,
stressed, or anxious a lot or between a little and a lot, which could be
an effect of COVID-19.</p>
<pre class="r"><code>anx_dep %&gt;%
  drop_na(worfeelevl) %&gt;% 
  group_by(year, worfeelevl) %&gt;% 
  summarize(count = n()) %&gt;% 
  group_by(year) %&gt;% 
  summarize(
     percentage=100 * count/sum(count),
     sum_count = sum(count),
     worfeelevl = worfeelevl,
     count=count
  ) %&gt;% 
  mutate(
    text_label = str_c(count, &quot; out of &quot;, sum_count)
  ) %&gt;% 
  plot_ly(
    y = ~percentage,
    x = ~year,
    color = ~worfeelevl,
    type = &quot;bar&quot;, 
    colors = &quot;viridis&quot;,
    text = ~text_label
  ) %&gt;% 
  layout(
    xaxis = list (title = &quot;&quot;),
    yaxis = list (title = &quot;Percentage&quot;), 
    barmode = &#39;stack&#39;,
    legend = list(orientation = &#39;h&#39;)
  )</code></pre>
<div id="htmlwidget-0a084172b48e5a600ef9" style="width:90%;height:576px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-0a084172b48e5a600ef9">{"x":{"visdat":{"bbbc740f3b8a":["function () ","plotlyVisDat"]},"cur_data":"bbbc740f3b8a","attrs":{"bbbc740f3b8a":{"y":{},"x":{},"text":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":""},"yaxis":{"domain":[0,1],"automargin":true,"title":"Percentage"},"barmode":"stack","legend":{"orientation":"h"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"y":[11.2369836365717,10.4978813559322,10.9542842867849,10.8168474792597,12.1733855916387,10.9410196294764,11.0665754228175],"x":[2015,2016,2017,2018,2019,2020,2021],"text":["982 out of 8739","991 out of 9440","877 out of 8006","1695 out of 15670","2609 out of 21432","2380 out of 21753","2264 out of 20458"],"type":"bar","name":"A lot","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"y":[32.2576953884884,30.7944915254237,33.349987509368,34.0970006381621,37.2060470324748,38.174044959316,38.5814840160328],"x":[2015,2016,2017,2018,2019,2020,2021],"text":["2819 out of 8739","2907 out of 9440","2670 out of 8006","5343 out of 15670","7974 out of 21432","8304 out of 21753","7893 out of 20458"],"type":"bar","name":"Somewhere between a little and a lot","marker":{"color":"rgba(33,144,141,1)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,1)"},"error_y":{"color":"rgba(33,144,141,1)"},"error_x":{"color":"rgba(33,144,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"y":[56.5053209749399,58.7076271186441,55.6957282038471,55.0861518825782,50.6205673758865,50.8849354112076,50.3519405611497],"x":[2015,2016,2017,2018,2019,2020,2021],"text":["4938 out of 8739","5542 out of 9440","4459 out of 8006","8632 out of 15670","10849 out of 21432","11069 out of 21753","10301 out of 20458"],"type":"bar","name":"A little","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
