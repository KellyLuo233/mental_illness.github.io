<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Statistical Analysis</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="https://github.com/KellyLuo233/mental_illness.github.io.git">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="data_process.html">Data Process</a>
</li>
<li>
  <a href="mental_illness.html">Mental Illness</a>
</li>
<li>
  <a href="anxiety_trend_dashboard.html">Anxiety Trend Dashboard</a>
</li>
<li>
  <a href="anxiety_trend.html">Anxiety Trend</a>
</li>
<li>
  <a href="depression_trend_dashboard.html">Depression Trend Dashboard</a>
</li>
<li>
  <a href="depression_trend.html">Depression Trend</a>
</li>
<li>
  <a href="suicide_analysis.html">Suicide Analysis</a>
</li>
<li>
  <a href="statistical_analysis.html">Statistical Analysis</a>
</li>
<li>
  <a href="project_report.html">Project Report</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Statistical Analysis</h1>

</div>


<div id="regression-analyses" class="section level2">
<h2>Regression Analyses</h2>
<pre class="r"><code>regression_df = 
  read_csv(&quot;data/nhis_data01.csv&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  filter(year == 2020) %&gt;% 
  select(worrx, deprx, age, sex, poverty, marst, cvddiag) %&gt;% 
  mutate(
    sex = recode_factor(sex, 
                        &quot;1&quot; = &quot;_Male&quot;, 
                        &quot;2&quot; = &quot;_Female&quot;),
    marital_status = recode_factor(marst, 
                        &quot;10&quot; = &quot;_Married&quot;, &quot;11&quot; = &quot;_Married&quot;,&quot;12&quot; = &quot;_Married&quot;,&quot;13&quot; = &quot;_Married&quot;,
                        &quot;20&quot; = &quot;_Widowed&quot;,&quot;30&quot; = &quot;_Divorced&quot;,&quot;40&quot; = &quot;_Separated&quot;,
                        &quot;50&quot; = &quot;_Never married&quot;),
    poverty = recode_factor(poverty, 
                        &quot;11&quot; = &quot;_Less than 1.0&quot;, &quot;12&quot; = &quot;_Less than 1.0&quot;, 
                        &quot;13&quot; = &quot;_Less than 1.0&quot;, &quot;14&quot; = &quot;_Less than 1.0&quot;,
                        &quot;21&quot; = &quot;_1.0-2.0&quot;, &quot;22&quot; = &quot;_1.0-2.0&quot;, 
                        &quot;23&quot; = &quot;_1.0-2.0&quot;, &quot;24&quot; = &quot;_1.0-2.0&quot;, 
                        &quot;25&quot; = &quot;_1.0-2.0&quot;,
                        &quot;31&quot; = &quot;_2.0 and above&quot;,&quot;32&quot; = &quot;_2.0 and above&quot;,
                        &quot;33&quot; = &quot;_2.0 and above&quot;,&quot;34&quot; = &quot;_2.0 and above&quot;,
                        &quot;35&quot; = &quot;_2.0 and above&quot;,&quot;36&quot; = &quot;_2.0 and above&quot;,
                        &quot;37&quot; = &quot;_2.0 and above&quot;,&quot;38&quot; = &quot;_2.0 and above&quot;),
    worrx = ifelse(worrx&gt;=3, NA, worrx),
    deprx = ifelse(deprx&gt;=3, NA, deprx),
    worrx = recode_factor(worrx,
                          &#39;1&#39; = 0, 
                          &#39;2&#39; = 1),
    deprx = recode_factor(deprx, &#39;1&#39; = 0, &#39;2&#39; = 1),
    cvddiag = recode_factor(cvddiag, 
                            &quot;1&quot; = &quot;_Never had COVID-19&quot;, 
                          &quot;2&quot; = &quot;_Had COVID-19&quot;)
    ) %&gt;%
  drop_na(worrx, deprx, sex, poverty, marital_status, cvddiag)</code></pre>
<div id="worries-and-anxiety" class="section level3">
<h3><strong>Worries and anxiety</strong></h3>
<p>Whether taken medication for worried, nervous, or anxious feelings is
associated with COVID-19 adjusting for age, sex, family income level and
current marital status.</p>
<div id="mosaic-plot" class="section level4">
<h4>Mosaic Plot</h4>
<p>The Mosaic Plot included four categorical variables and it was used
to visualize the proportional relationship between these variables and
the outcome (whether or not taken medication for worried, nervous, or
anxious feelings) in the population.</p>
<p>Based on the plot, we can observe that compared to the other three
variables (sex, family income level, and current marital status), there
was no obvious difference in the proportion of people who took
medication for anxiety when comparing those who had COVID-19 with those
who never had COVID-19. That is, having had COVID-19 or not had no
significant effect on whether or not taking medication for anxiety in
the population.</p>
<pre class="r"><code>sex_worrx = 
  regression_df %&gt;%
  ggplot() + 
  geom_mosaic(
    aes(
      x = product(worrx, sex),
      fill = worrx
    ),
    offset = 0.01,
    show.legend = FALSE
  )+ 
  labs(
    x=&quot;&quot;, 
   y=&quot;&quot;
  )+
  theme(
    axis.text.y = element_blank(),
    axis.ticks.y=element_blank(),
    axis.text.x = element_text(angle = 90, hjust = 1)
  )

poverty_worrx = 
  regression_df %&gt;%
  ggplot() + 
  geom_mosaic(
    aes(
      x = product(worrx, poverty),
      fill = worrx
    ),
    offset = 0.01
  )+ 
  labs(
    x=&quot;&quot;, 
    y=&quot;&quot;,
    fill = &quot;Whether taken medicine for anxiety&quot;)+
  theme(
    axis.text.y = element_blank(),
    axis.ticks.y=element_blank(),
    axis.text.x = element_text(angle = 90, hjust = 1)
  )

marital_status_worrx = 
  regression_df %&gt;%
  ggplot() + 
  geom_mosaic(
    aes(
      x = product(worrx, marital_status),
      fill = worrx
    ),
    offset = 0.01,
    show.legend = FALSE
  )+ 
  labs(
    x=&quot;&quot;, 
    y=&quot;&quot;
  )+
  theme(
    axis.text.y = element_blank(),
    axis.ticks.y=element_blank(),
    axis.text.x = element_text(angle = 90, hjust = 1)
  )

cvddiag_worrx = 
  regression_df %&gt;%
  ggplot() + 
  geom_mosaic(
    aes(
      x = product(worrx, cvddiag),
      fill = worrx
    ),
    offset = 0.01,
    show.legend = FALSE
  )+ 
  labs(
    x=&quot;&quot;, 
  y=&quot;&quot;
  )+
  theme(
    axis.text.y = element_blank(),
    axis.ticks.y=element_blank(),
    axis.text.x = element_text(angle = 90, hjust = 1),
  )
  
sex_worrx + poverty_worrx + marital_status_worrx +cvddiag_worrx + plot_layout(ncol = 4)</code></pre>
<p><img src="statistical_analysis_files/figure-html/unnamed-chunk-2-1.png" width="90%" /></p>
</div>
<div id="diagnostics" class="section level4">
<h4>Diagnostics</h4>
<p>We seek to validate our models and assess its goodness of fit. In our
motivating example, we have two models: (1) Crude model and (2) Adjusted
model.</p>
<ul>
<li>The crude model only has the outcome ( Whether taking medication for
worried, nervous, or anxious feelings = Yes/No) and the predictor of
interest (COVID-19 Status).</li>
<li>The adjusted model has the outcome and predictor of interest
(COVID-19 Status) along with other with four covariates (Sex, Age,
Poverty(family income level),and Current Marital Status).</li>
</ul>
<p>We can assess which of these two models fit the data better using the
likelihood ratio test.</p>
<pre class="r"><code>anxiety_crude_model = 
  glm(worrx ~ cvddiag, family=binomial(link=&#39;logit&#39;),
                            data = regression_df)</code></pre>
<pre class="r"><code>anxiety_adjusted_model = 
  glm(worrx ~ sex + poverty + age + marital_status + cvddiag, 
                            family=binomial(link=&#39;logit&#39;),
                            data = regression_df)</code></pre>
<pre class="r"><code>lrtest(anxiety_crude_model, anxiety_adjusted_model) %&gt;% 
kbl(caption     = &quot;Likelihood ratio test for crude model and adjusted model&quot;, col.names   = c(&quot;Total df for each model&quot;, &quot;LogLik&quot;, &quot;difference in df&quot;, &quot;Chisq-statistic&quot;, &quot;p-value&quot;)) %&gt;% 
  kable_paper(&quot;striped&quot;, full_width = F) %&gt;% 
  column_spec(1, bold = T)</code></pre>
<table class=" lightable-paper lightable-striped" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Likelihood ratio test for crude model and adjusted model
</caption>
<thead>
<tr>
<th style="text-align:right;">
Total df for each model
</th>
<th style="text-align:right;">
LogLik
</th>
<th style="text-align:right;">
difference in df
</th>
<th style="text-align:right;">
Chisq-statistic
</th>
<th style="text-align:right;">
p-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;">
-6729.534
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;font-weight: bold;">
10
</td>
<td style="text-align:right;">
-6526.447
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
406.1741
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<ul>
<li>Goodness of Fit</li>
<li>Likelihood ratio test The resulting p-value is so small it’s very
close to 0, so we can reject the null hypothesis. The p&lt;0.00001
suggesting that the adjusted model with five covariates (Sex, Age,
Poverty(family income level), Current Marital Status and COVID-19
Status) fits the data significantly better than the crude model.</li>
</ul>
</div>
<div id="results" class="section level4">
<h4>Results</h4>
<p>Since four of these main effects were categorical variables, so we
need to create dummy variables that indicate which levels of the
predictors a given individual belonged. The outcome for this logistic
regression is binary (Whether taking medication for worried, nervous, or
anxious feelings = Yes/No).</p>
<ul>
<li>The variable <code>Sex</code> has one dummy variable and
<code>Sex_Male</code> is the reference group.</li>
<li>The variable <code>poverty</code> has two dummy variables and
<code>poverty_less than 1.0</code> is the reference group.</li>
<li>The variable <code>marital_status</code> has four dummy variables
and <code>marital_status_Married</code> is the reference group.</li>
<li>The variable <code>cvddiag(COVID-19 status)</code>has one dummy
variable and <code>cvddiag_Had COVID-19</code> is the reference
group.</li>
</ul>
<pre class="r"><code>anxiety_adjusted_model %&gt;%  
   broom::tidy() %&gt;% 
  mutate(OR = exp(estimate),
         Lower_CI = exp(estimate -1.96*std.error),
         Upper_CI = exp(estimate +1.96*std.error)) %&gt;%
  select(term, OR, Lower_CI, Upper_CI, statistic, p.value) %&gt;% 
  kbl(caption     = &quot;Effect of Selected Predictors on whether taking medication for worried, nervous, or anxious feelings&quot;
    , col.names   = c(&quot;Predictors&quot;, &quot;OR&quot;, &quot;Lower bound of 95% CI&quot;,&quot;Upper bound of 95% CI&quot;, &quot;t-statistic&quot;, &quot;p-value&quot;),
    digits= 2) %&gt;% 
  kable_paper(&quot;striped&quot;, full_width = F) %&gt;% 
  column_spec(1, bold = T)</code></pre>
<table class=" lightable-paper lightable-striped" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Effect of Selected Predictors on whether taking medication for worried,
nervous, or anxious feelings
</caption>
<thead>
<tr>
<th style="text-align:left;">
Predictors
</th>
<th style="text-align:right;">
OR
</th>
<th style="text-align:right;">
Lower bound of 95% CI
</th>
<th style="text-align:right;">
Upper bound of 95% CI
</th>
<th style="text-align:right;">
t-statistic
</th>
<th style="text-align:right;">
p-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
(Intercept)
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
-23.28
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
sex_Female
</td>
<td style="text-align:right;">
2.29
</td>
<td style="text-align:right;">
2.08
</td>
<td style="text-align:right;">
2.53
</td>
<td style="text-align:right;">
16.73
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
poverty_1.0-2.0
</td>
<td style="text-align:right;">
0.81
</td>
<td style="text-align:right;">
0.69
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
-2.44
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
poverty_2.0 and above
</td>
<td style="text-align:right;">
0.67
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;">
0.78
</td>
<td style="text-align:right;">
-5.38
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
age
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
-0.66
</td>
<td style="text-align:right;">
0.51
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
marital_status_Widowed
</td>
<td style="text-align:right;">
0.94
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
1.09
</td>
<td style="text-align:right;">
-0.81
</td>
<td style="text-align:right;">
0.42
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
marital_status_Divorced
</td>
<td style="text-align:right;">
1.41
</td>
<td style="text-align:right;">
1.25
</td>
<td style="text-align:right;">
1.60
</td>
<td style="text-align:right;">
5.54
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
marital_status_Separated
</td>
<td style="text-align:right;">
1.54
</td>
<td style="text-align:right;">
1.12
</td>
<td style="text-align:right;">
2.12
</td>
<td style="text-align:right;">
2.63
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
marital_status_Never married
</td>
<td style="text-align:right;">
1.10
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
1.24
</td>
<td style="text-align:right;">
1.56
</td>
<td style="text-align:right;">
0.12
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
cvddiag_Had COVID-19
</td>
<td style="text-align:right;">
1.20
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
1.50
</td>
<td style="text-align:right;">
1.62
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
</tbody>
</table>
<p>After adjustment for sex, age, poverty(family income level), and
Current Marital Status, we obtained the <code>p-value</code> for the
variable <code>cvddiage(COVID-19 status)</code>is 0.11 &gt; α=0.05.
Hence, we found no statistically significant association between
COVID-19 status and taking medication for worried, nervous, or anxious
feelings (aOR: 1.20, 95% CI: 0.96, 1.50). In addition, the findings in
the statistical analysis matches what we get in the anxiety trend
section of our exploratory analysis. Due to the Table 2 fallacy, we
should avoid interpreting covariates other than the exposure of
interest, but they are included here for completeness.</p>
</div>
</div>
<div id="depression" class="section level3">
<h3><strong>Depression</strong></h3>
<p>Whether taken medication for depression is associated with COVID-19
adjusting for age, sex, family income level and current marital
status.</p>
<div id="mosaic-plot-1" class="section level4">
<h4>Mosaic Plot</h4>
<p>The Mosaic Plot included four categorical variables and it was used
to visualize the proportional relationship between these variables and
the outcome (whether or not taken medication for depression) in the
population.</p>
<p>Based on the plot, we can observe that compared to the other three
variables (sex, family income level, and current marital status), there
was no obvious difference in the proportion of people who took
medication for depression when comparing those who had COVID-19 with
those who never had COVID-19. That is, having had COVID-19 or not had no
significant effect on whether or not taking medication for depression in
the population.</p>
<pre class="r"><code>sex_deprx = 
  regression_df %&gt;%
  ggplot() + 
  geom_mosaic(
    aes(
      x = product(deprx, sex),
      fill = deprx
    ),
    offset = 0.01,
    show.legend = FALSE
  )+ 
  labs(
    x=&quot;&quot;, 
   y=&quot;&quot;
  )+
  theme(
    axis.text.y = element_blank(),
    axis.ticks.y=element_blank(),
    axis.text.x = element_text(angle = 90, hjust = 1)
  )

poverty_deprx = 
  regression_df %&gt;%
  ggplot() + 
  geom_mosaic(
    aes(
      x = product(deprx, poverty),
      fill = deprx
    ),
    offset = 0.01
  )+ 
  labs(
    x=&quot;&quot;, 
    y=&quot;&quot;,
    fill = &quot;Whether taken medicine for depression&quot;)+
  theme(
    axis.text.y = element_blank(),
    axis.ticks.y=element_blank(),
    axis.text.x = element_text(angle = 90, hjust = 1)
  )

marital_status_deprx = 
  regression_df %&gt;%
  ggplot() + 
  geom_mosaic(
    aes(
      x = product(deprx, marital_status),
      fill = deprx
    ),
    offset = 0.01,
    show.legend = FALSE
  )+ 
  labs(
    x=&quot;&quot;, 
    y=&quot;&quot;
  )+
  theme(
    axis.text.y = element_blank(),
    axis.ticks.y=element_blank(),
    axis.text.x = element_text(angle = 90, hjust = 1)
  )

cvddiag_deprx = 
  regression_df %&gt;%
  ggplot() + 
  geom_mosaic(
    aes(
      x = product(deprx, cvddiag),
      fill = deprx
    ),
    offset = 0.01,
    show.legend = FALSE
  )+ 
  labs(
    x=&quot;&quot;, 
  y=&quot;&quot;
  )+
  theme(
    axis.text.y = element_blank(),
    axis.ticks.y=element_blank(),
    axis.text.x = element_text(angle = 90, hjust = 1),
  )
  
sex_deprx + poverty_deprx + marital_status_deprx +cvddiag_deprx + plot_layout(ncol = 4)</code></pre>
<p><img src="statistical_analysis_files/figure-html/unnamed-chunk-9-1.png" width="90%" /></p>
</div>
<div id="diagnostics-1" class="section level4">
<h4>Diagnostics</h4>
<p>We seek to validate our models and assess its goodness of fit. In our
motivating example, we have two models: (1) Crude model and (2) Adjusted
model.</p>
<ul>
<li>The crude model only has the outcome (Whether taking medication for
depression = Yes/No) and the predictor of interest (COVID-19
Status).</li>
<li>The adjusted model has the outcome and predictor of interest along
with other with four covariates (Sex, Age, Poverty(family income
level),and Current Marital Status).</li>
</ul>
<p>We can assess which of these two models fit the data better using the
likelihood ratio test.</p>
<pre class="r"><code>depre_crude_model = 
  glm(deprx ~ cvddiag, 
                            family=binomial(link=&#39;logit&#39;),
                            data = regression_df)</code></pre>
<pre class="r"><code>depre_adjusted_model = 
  glm(deprx ~ sex + poverty + age + marital_status + cvddiag, 
                            family=binomial(link=&#39;logit&#39;),
                            data = regression_df)</code></pre>
<pre class="r"><code>lrtest(depre_crude_model, depre_adjusted_model) %&gt;% 
  kbl(caption     = &quot;Likelihood ratio test for crude model and adjusted model&quot;, col.names   = c(&quot;Total df for each model&quot;, &quot;LogLik&quot;, &quot;difference in df&quot;, &quot;Chisq-statistic&quot;, &quot;p-value&quot;)) %&gt;% 
  kable_paper(&quot;striped&quot;, full_width = F) %&gt;% 
  column_spec(1, bold = T)</code></pre>
<table class=" lightable-paper lightable-striped" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Likelihood ratio test for crude model and adjusted model
</caption>
<thead>
<tr>
<th style="text-align:right;">
Total df for each model
</th>
<th style="text-align:right;">
LogLik
</th>
<th style="text-align:right;">
difference in df
</th>
<th style="text-align:right;">
Chisq-statistic
</th>
<th style="text-align:right;">
p-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;">
-6202.243
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;font-weight: bold;">
10
</td>
<td style="text-align:right;">
-5984.946
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
434.5956
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<ul>
<li>Goodness of Fit</li>
<li>Likelihood ratio test The resulting p-value is so small it’s very
close to 0, so we can reject the null hypothesis. The p&lt;0.00001
suggesting that the adjusted model with five covariates (Sex, Age,
Poverty(family income level), Current Marital Status and COVID-19
Status) fits the data significantly better than the crude model.</li>
</ul>
</div>
<div id="results-1" class="section level4">
<h4>Results</h4>
<p>Since four of these main effects were categorical variables, so we
need to create dummy variables that indicate which levels of the
predictors a given individual belonged. The outcome for this logistic
regression is binary (Whether taking medication for depression =
Yes/No).</p>
<ul>
<li>The variable <code>Sex</code> has one dummy variable and
<code>Sex_Male</code> is the reference group.</li>
<li>The variable <code>poverty</code> has two dummy variables and
<code>poverty_less than 1.0</code> is the reference group.</li>
<li>The variable <code>marital_status</code> has four dummy variables
and <code>marital_status_Married</code> is the reference group.</li>
<li>The variable <code>cvddiag(COVID-19 status)</code>has one dummy
variable and <code>cvddiag_Had COVID-19</code> is the reference
group.</li>
</ul>
<pre class="r"><code>depre_adjusted_model %&gt;%  
   broom::tidy() %&gt;% 
  mutate(OR = exp(estimate),
         Lower_CI = exp(estimate -1.96*std.error),
         Upper_CI = exp(estimate +1.96*std.error)) %&gt;%
  select(term, OR, Lower_CI, Upper_CI, statistic, p.value) %&gt;% 
  kbl(caption     = &quot;Effect of Selected Predictors on whether taking medication for depression&quot;
    , col.names   = c(&quot;Predictors&quot;, &quot;OR&quot;, &quot;Lower bound of 95% CI&quot;,&quot;Upper bound of 95% CI&quot;, &quot;t-statistic&quot;, &quot;p-value&quot;),
    digits= 2) %&gt;% 
  kable_paper(&quot;striped&quot;, full_width = F) %&gt;% 
  column_spec(1, bold = T)</code></pre>
<table class=" lightable-paper lightable-striped" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Effect of Selected Predictors on whether taking medication for
depression
</caption>
<thead>
<tr>
<th style="text-align:left;">
Predictors
</th>
<th style="text-align:right;">
OR
</th>
<th style="text-align:right;">
Lower bound of 95% CI
</th>
<th style="text-align:right;">
Upper bound of 95% CI
</th>
<th style="text-align:right;">
t-statistic
</th>
<th style="text-align:right;">
p-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
(Intercept)
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
-24.11
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
sex_Female
</td>
<td style="text-align:right;">
2.39
</td>
<td style="text-align:right;">
2.16
</td>
<td style="text-align:right;">
2.66
</td>
<td style="text-align:right;">
16.42
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
poverty_1.0-2.0
</td>
<td style="text-align:right;">
0.76
</td>
<td style="text-align:right;">
0.64
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
-3.18
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
poverty_2.0 and above
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
0.69
</td>
<td style="text-align:right;">
-6.91
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
age
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.88
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
marital_status_Widowed
</td>
<td style="text-align:right;">
1.08
</td>
<td style="text-align:right;">
0.92
</td>
<td style="text-align:right;">
1.26
</td>
<td style="text-align:right;">
0.94
</td>
<td style="text-align:right;">
0.35
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
marital_status_Divorced
</td>
<td style="text-align:right;">
1.49
</td>
<td style="text-align:right;">
1.31
</td>
<td style="text-align:right;">
1.69
</td>
<td style="text-align:right;">
6.11
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
marital_status_Separated
</td>
<td style="text-align:right;">
1.28
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
1.82
</td>
<td style="text-align:right;">
1.35
</td>
<td style="text-align:right;">
0.18
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
marital_status_Never married
</td>
<td style="text-align:right;">
1.08
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
1.23
</td>
<td style="text-align:right;">
1.25
</td>
<td style="text-align:right;">
0.21
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
cvddiag_Had COVID-19
</td>
<td style="text-align:right;">
1.12
</td>
<td style="text-align:right;">
0.89
</td>
<td style="text-align:right;">
1.43
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.34
</td>
</tr>
</tbody>
</table>
<p>After adjustment for sex, age, poverty(family income level), and
Current Marital Status, we obtained the <code>p-value</code> for the
variable <code>cvddiage(COVID-19 status)</code>is 0.34 &gt; α=0.05.
Hence, we found no statistically significant association between
COVID-19 status and taking medication for depression (aOR: 1.12, 95% CI:
0.89, 1.43). In addition, the findings in the statistical analysis
matches what we get in the depression trend section of our exploratory
analysis. Due to the Table 2 fallacy, we should avoid interpreting
covariates other than the exposure of interest, but they are included
here for completeness.</p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
